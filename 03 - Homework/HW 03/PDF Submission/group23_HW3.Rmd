---
title:    "Homework 3 - Integer Programming"
subtitle: "Adv. Analytics and Metaheuristics"
author:   "Daniel Carpenter and Iker Zarandona"
date:     "March 2022"
fontsize: 12pt
geometry: margin=1in
output:
  pdf_document: 
    toc: yes
    number_sections: yes
    highlight: kate
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

\newpage
# - Problem `1`

## Mathematical Formulation

### Sets
Set Name | Description 
---------|--------------
$GENERATORS$	| Set of generators $i$ that can be used (`A`,`B`,`C`)
$PERIODS$	    | 2 possible periods $p$ (`1`, `2`) in the production day 


### Parameters
Parameter Name | Description 
---------------|--------------
$S_i$      | Fixed cost to start a generator ($i \in GENERATORS$) in the entire day
$F_i$      | Fixed cost to operate a generator ($i \in GENERATORS$) in any period
$C_i$      | Variable cost per megawatt to operator a generator ($i \in GENERATORS$) in any period
$U_i$      | Max. megawatts generated for generator ($i \in GENERATORS$) in any period
$demand_p$ | Total demanded megawatts for period ($p \in PERIODS$)
$M$  	     | Large constant to map watts used by each generator ($i \in GENERATORS$)


### Decision Variables
Variable Name | Description 
--------------|--------------
$watts_{i,p}$	| *Integer variable*: Number of watts to produce per generator ($i \in GENERATORS$) per period ($p \in PERIODS$)
$x_{i,p}$	    | *Binary variable*: `1` if a generator ($i \in GENERATORS$) is in period $p$ ($p \in PERIODS$), `0` if not turned on at all
$y_i$	        | *Binary variable*: `1` if a generator ($i \in GENERATORS$) is used, `0` if not turned on at all


### Objective Function
$$
minimize \ cost: \ 
\sum_{i \in GENERATORS} 
\begin{pmatrix} 
  (\sum_{p \in PERIODS}(watts_{i,p}) \times C_i) + (F_i \times \sum_{p \in PERIODS} x_{i,p} ) + (S_i \times y_i)
\end{pmatrix} 
$$


### Constraints

**C1:** For each period, meet the demanded megawatts
$$
requiredWatts: \ \sum_{i \in GENERATORS}(watts_{i,p}) = demand_p, 
\forall \ p \in PERIODS
$$

**C2:** For each generator, don't surpass the allowable megawatts 
$$
upperBound: \ \sum_{p \in PERIODS}(watts_{i,p}) \leq U_i, 
\forall \ i \in GENERATORS
$$

**C3:** For each generator, map decision variables together to account for the fixed costs in a given day $S_i$
$$
mapVars: \ \sum_{p \in PERIODS}(watts_{i,p}) \leq M_i \times y_i,
\forall \ i \in GENERATORS
$$

**C4:** For each generator and period, map decision variables $y$ and $watts$ together to account for the fixed costs in a per period $p$
$$
mapVars2: watts_{i,p} \leq M_i \times x_{i,p}
, \forall \ i \in GENERATORS, \ p \in PERIODS
$$

**C5** Non-negativity or Binary restraints of decision variables
$$
watts_{i,p} \geq 0
$$
$$
x_{i,p}, \ y_i \in (0,1)
$$

\newpage

## Code and Output

### Code
![ ]("Images/prob1CodeAndData.png"){ width=100% }

### Output
![ ]("Images/prob1Output.png"){ width=80% }

#### Analysis of the Output
* The minimized cost is $\$46,100$
* Generator $A$, $B$, and $C$ run
* Generator $C$ runs in period $1$. Generator $A$ and $B$ run in period $2$
* Generator $A$ produces $2,100$ megawatts in total
* Generator $B$ produces $1,800$ megawatts in total
* Generator $C$ produces $2,900$ megawatts in total


\newpage
# - Problem `2 (a)` 

## Mathematical Formulation

### Sets
Set Name | Description 
---------|--------------
$PRODUCTS$ | 5 types of landscaping and construction products (e.g., cement, sand, etc.) labeled product ($p$) $A, B, C, D,\text{ and } E$
$SILOS$    | 8 different silos $s$ that each product must be stored in $(1,2,\dots,8)$


### Parameters
Parameter Name | Description 
---------------|--------------
$cost_{s,p}$   | Cost of storing *one ton* of product $p \in PRODUCTS$ in silo $s \in SILOS$
$supply_p$     | Total supply *in tons* available of product $p \in PRODUCTS$
$capacity_s$   | Total capacity *in tons* of silo $s \in SILOS$. Can store products.
$M$            | Variable to map *decision variable* $tonsOfProduct_{p,s}$ to $isStored_{p,s}$. Uses big M method.


### Decision Variables
Variable Name | Description 
--------------|--------------
$tonsOfProduct_{p,s}$ | *Tons* of product $p \in PRODUCTS$ to store in silo $s \in SILOS$. Non-negative.
$isStored_{p,s}$      | *Binary variable* indicating if product $p \in PRODUCTS$ is stored in silo $s \in SILOS$.




### Objective Function
$$
minimize \ costOfStorage: \sum_{p \in PRODUCTS}\sum_{s \in SILOS} tonsOfProduct_{p,s} \times cost_{p,s} 
$$

\newpage

### Constraints

**C1:** For each silo $s$, the *tons* of the supplied product $p$ must be less than or equal to the capacity limit of silo $s$
$$
meetCapacity: \sum_{p \in PRODUCTS} tonsOfProduct_{p,s} \leq capacity_s
, \ \forall \ s \in SILOS
$$

**C2:** For each product $p$, must use all of the total product that is available
$$
useAllProduct: \sum_{s \in SILOS} tonsOfProduct_{p,s} = supply_p
, \ \forall \ p \in PRODUCTS
$$

**C3:** For each silo $s$ and product $p$, 
$$
oneProductInSilo: \sum_{p in PRODUCTS} isStored_{p,s} = 1
, \ \forall \ s \in SILOS
$$

**C4:** Map the decision variables together using the Big M method 
$$
mapVars: tonsOfProduct_{p,s} \leq M \times isStored_{p,s}
, \ \forall \ p \in PRODUCTS, \ \forall \ s \in SILOS
$$

**C5** Non-negativity or Binary restraints of decision variables
$$
tonsOfProduct_{p,s} \geq 0
$$
$$
isStored_{p,s} \in (0, 1)
$$

\newpage

## Code and Output

### Code
![ ]("Images/prob2CodeAndData.png"){ width=100% }

\newpage

### Output
![ ]("Images/prob2Output.png"){ width=70% }

#### Analysis of the Output
* Minimized loading cost for 250 tons of 5 products over the 8 silos is $320$ (problem does not state cost units).
* Product $A$ stores $25 \ tons$ in $silo \ 1$ and $50 \ tons$ in $silo \ 4$
* Product $B$ stores $50 \ tons$ in $silo \ 5$
* Product $C$ stores $25 \ tons$ in $silo \ 3$
* Product $D$ stores $25 \ tons$ in $silo \ 2$, $5 tons$ in $silo \ 7$, and and $50 \ tons$ in $silo \ 8$
* Product $E$ stores $20 \ tons$ in $silo \ 6$

\newpage

# - Problem `2 (b)` 
> Additional constraint so that no tanks can be partially filled  

Add the decision variable $z_s$ which will allow be used to either 
fill a silo $s \in SILOS$ or not fill the silo $s$ using two new constraints.

## New Constraints

**C6** Possibility 1: For each silo $s$, its capacity must be at 100%
$$
mustBeFull: \sum_{p \in PRODUCTS} tonsOfProduct_{p,s} = capacity_s + (M \times z_s)
, \ \forall \ s \in SILOS
$$

**C7** Possibility 2: For each silo $s$, the capacity must not be utilized (0%).
$$
mustBeEmpty: \sum_{p \in PRODUCTS} tonsOfProduct_{p,s} = 0 + [M \times (1 - z_s)]
, \ \forall \ s \in SILOS
$$

**C9** For each silo, We must store at 0% or 100%
$$
onlyOneConstraint: z[s] = 1;
, \ \forall \ s \in SILOS
$$


## Code and Output

